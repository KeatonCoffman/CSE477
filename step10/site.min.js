/*! step10 2017-06-24 */

function Buttons(){this.on=1;this.update(1);for(var t=1;t<=3;t++)this.configButton(t)}function Simon(t){this.form=$(t),this.curr_state="initial",this.game_sequence=[],this.current=0,this.button_press=[],this.button_colors=["Red","Green","Blue","Yellow"];for(var e=0;e<this.form.find("input").length;e++)this.setButton($(this.form.find("input").get(e)));this.play()}Buttons.prototype.configButton=function(t){var e=3==t?1:t+1,n=this;$("#b"+t).click(function(){n.on==t&&n.update(e)})},Buttons.prototype.update=function(t){this.on=t,$("#b1").css("background-color",1==this.on?"red":"green"),$("#b2").css("background-color",2==this.on?"red":"green"),$("#b3").css("background-color",3==this.on?"red":"green"),$("#b1").html(1==this.on?"Press Me":"&nbsp;"),$("#b2").html(2==this.on?"Press Me":"&nbsp;"),$("#b3").html(3==this.on?"Press Me":"&nbsp;")},Simon.prototype.setButton=function(t){var e=this;t.mousedown(function(e){t.css("background-color",this.value)}),t.mouseup(function(e){t.css("background-color","lightgrey")}),t.click(function(t){var n=this.value,o=this;e.buttonPress(n),"fail"===e.curr_state?(document.getElementById("Buzzer").currentTime=0,document.getElementById("Buzzer").play(),window.setTimeout(function(){e.failstate(o)},1e3)):"play"===e.curr_state?(e.playstate(this),console.log(e.game_sequence),window.setTimeout(function(){e.button_press=[],e.play()},1e3)):e.enterstate(this)})},Simon.prototype.play=function(){this.curr_state="play",this.current=0,this.game_sequence.push(Math.floor(4*Math.random())),this.playCurrent()},Simon.prototype.playCurrent=function(){var t=this;if(this.current<this.game_sequence.length){var e=this.game_sequence[this.current];document.getElementById(t.button_colors[e]).currentTime=0,document.getElementById(t.button_colors[e]).play(),this.buttonOn(e),this.current++,window.setTimeout(function(){t.playCurrent()},1e3)}else this.buttonOn(-1),this.curr_state="enter"},Simon.prototype.buttonOn=function(t){var e=this;-1!==t?($("input").css("background-color","lightgrey"),$(e.form.find("input").get(t)).css("background-color",e.button_colors[t])):$("input").css("background-color","lightgrey")},Simon.prototype.buttonPress=function(t){if(this.button_press.length<this.game_sequence.length){this.button_press[this.button_press.length]=this.button_colors.indexOf(t);for(var e=0;e<this.button_press.length;e++){if(this.button_press[e]!==this.game_sequence[e])return void(this.curr_state="fail");this.curr_state="enter"}this.button_press.length===this.game_sequence.length&&(this.curr_state="play")}},Simon.prototype.failstate=function(){this.game_sequence=[],this.button_press=[],this.play()},Simon.prototype.playstate=function(t){document.getElementById(t.value).currentTime=0,document.getElementById(t.value).play()},Simon.prototype.enterstate=function(t){document.getElementById(t.value).currentTime=0,document.getElementById(t.value).play()};